<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Blank Page Issue</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .debug-section {
            background: white;
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #007AFF;
        }
        .error { border-left-color: #ff4444; background: #fff5f5; }
        .success { border-left-color: #44ff44; background: #f5fff5; }
        .console-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>üîç Debug: Blank Page Issue</h1>
    
    <div class="debug-section">
        <h3>üìã Basic HTML Test</h3>
        <div id="html-test">Testing if HTML loads...</div>
    </div>

    <div class="debug-section">
        <h3>üìÑ File Loading Tests</h3>
        <div id="file-tests">Running file tests...</div>
    </div>

    <div class="debug-section">
        <h3>üîß JavaScript Execution</h3>
        <div id="js-tests">Testing JavaScript...</div>
    </div>

    <div class="debug-section">
        <h3>üñ•Ô∏è Console Output</h3>
        <div id="console-output" class="console-output">Loading console...</div>
    </div>

    <script>
        // Console capture
        const consoleDiv = document.getElementById('console-output');
        const originalLog = console.log;
        const originalError = console.error;
        
        function addToConsole(type, ...args) {
            const timestamp = new Date().toLocaleTimeString();
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
            ).join(' ');
            
            const line = `[${timestamp}] ${type}: ${message}\n`;
            consoleDiv.textContent += line;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
            
            // Call original
            if (type === 'ERROR') originalError(...args);
            else originalLog(...args);
        }
        
        console.log = (...args) => addToConsole('LOG', ...args);
        console.error = (...args) => addToConsole('ERROR', ...args);

        // Test 1: Basic HTML
        document.getElementById('html-test').innerHTML = '‚úÖ HTML is loading correctly';
        console.log('‚úÖ HTML test passed');

        // Test 2: File accessibility
        async function testFiles() {
            const fileTests = document.getElementById('file-tests');
            const files = ['index.html', 'script.js', 'style.css', 'quiz-modules.json'];
            const results = [];
            
            for (const file of files) {
                try {
                    console.log(`üîç Testing file: ${file}`);
                    const response = await fetch(file);
                    if (response.ok) {
                        results.push(`‚úÖ ${file} - OK (${response.status})`);
                        console.log(`‚úÖ ${file} loaded successfully`);
                    } else {
                        results.push(`‚ùå ${file} - Error ${response.status}`);
                        console.error(`‚ùå ${file} failed with status ${response.status}`);
                    }
                } catch (error) {
                    results.push(`‚ùå ${file} - ${error.message}`);
                    console.error(`‚ùå ${file} error:`, error.message);
                }
            }
            
            fileTests.innerHTML = results.join('<br>');
        }

        // Test 3: JavaScript functionality
        async function testJavaScript() {
            const jsTests = document.getElementById('js-tests');
            const results = [];
            
            try {
                console.log('üß™ Testing JavaScript functionality...');
                
                // Test basic JS
                results.push('‚úÖ JavaScript execution works');
                console.log('‚úÖ Basic JavaScript works');
                
                // Test fetch capability
                try {
                    const testResponse = await fetch('quiz-modules.json');
                    if (testResponse.ok) {
                        const data = await testResponse.json();
                        results.push(`‚úÖ JSON loading works (${data.length} modules)`);
                        console.log(`‚úÖ JSON loaded: ${data.length} modules found`);
                        
                        // Test first few modules
                        data.slice(0, 3).forEach((module, index) => {
                            console.log(`üìã Module ${index + 1}: ${module.name} (${module.questions.length} questions)`);
                        });
                        
                    } else {
                        results.push(`‚ùå JSON loading failed: ${testResponse.status}`);
                        console.error(`‚ùå JSON loading failed: ${testResponse.status}`);
                    }
                } catch (jsonError) {
                    results.push(`‚ùå JSON error: ${jsonError.message}`);
                    console.error(`‚ùå JSON error:`, jsonError);
                }
                
                // Test DOM manipulation
                const testDiv = document.createElement('div');
                testDiv.textContent = 'DOM test';
                document.body.appendChild(testDiv);
                document.body.removeChild(testDiv);
                results.push('‚úÖ DOM manipulation works');
                console.log('‚úÖ DOM manipulation works');
                
            } catch (error) {
                results.push(`‚ùå JavaScript error: ${error.message}`);
                console.error('‚ùå JavaScript error:', error);
            }
            
            jsTests.innerHTML = results.join('<br>');
        }

        // Test 4: Try to load and execute the main script
        async function testMainScript() {
            try {
                console.log('üîç Testing main script loading...');
                
                // Try to fetch the main script
                const scriptResponse = await fetch('script.js');
                if (!scriptResponse.ok) {
                    console.error(`‚ùå script.js failed to load: ${scriptResponse.status}`);
                    return;
                }
                
                const scriptContent = await scriptResponse.text();
                console.log(`‚úÖ script.js loaded (${scriptContent.length} characters)`);
                
                // Check for common issues
                const issues = [];
                if (scriptContent.includes('class QuizApp')) {
                    console.log('‚úÖ QuizApp class found');
                } else {
                    issues.push('‚ùå QuizApp class not found');
                }
                
                if (scriptContent.includes('window.quizApp = new QuizApp()')) {
                    console.log('‚úÖ QuizApp initialization found');
                } else {
                    issues.push('‚ùå QuizApp initialization not found');
                }
                
                // Check for syntax errors (basic)
                if (scriptContent.includes('async loadQuizData()')) {
                    console.log('‚úÖ loadQuizData method found');
                } else {
                    issues.push('‚ùå loadQuizData method not found or malformed');
                }
                
                if (issues.length > 0) {
                    console.error('‚ùå Script issues found:', issues);
                } else {
                    console.log('‚úÖ script.js appears to be valid');
                }
                
            } catch (error) {
                console.error('‚ùå Error testing main script:', error);
            }
        }

        // Run all tests
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Starting blank page debug tests...');
            
            await testFiles();
            await testJavaScript();
            await testMainScript();
            
            console.log('‚úÖ Debug tests completed');
            
            // Final test: try to simulate the main app loading
            console.log('üéØ Final test: Simulating main app initialization...');
            
            try {
                // Check if we can find the typical elements that should be in index.html
                const checkElements = ['welcome-screen', 'module-screen', 'quiz-screen'];
                checkElements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        console.log(`‚úÖ Element #${id} would be found`);
                    } else {
                        console.log(`‚ÑπÔ∏è Element #${id} not in this test page (expected)`);
                    }
                });
                
            } catch (error) {
                console.error('‚ùå Final test error:', error);
            }
        });
    </script>
</body>
</html>
